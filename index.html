<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>Goorm ê³¼ì œ ì•„ì¹´ì´ë¸Œ (ì£¼ì°¨ë³„ ì •ë¦¬)</title>
    <style>
      :root {
        --primary: #006241;
        --bg: #f8f9fa;
      }
      body {
        font-family: "Pretendard", sans-serif;
        background: var(--bg);
        padding: 40px 20px;
      }
      .container {
        max-width: 700px;
        margin: 0 auto;
      }

      /* ì£¼ì°¨ë³„ ì•„ì½”ë””ì–¸ ìŠ¤íƒ€ì¼ */
      details {
        background: white;
        margin-bottom: 15px;
        border-radius: 12px;
        border: 1px solid #eee;
        overflow: hidden;
      }
      summary {
        padding: 20px;
        font-weight: 800;
        cursor: pointer;
        list-style: none;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #fff;
        color: var(--primary);
      }
      summary::-webkit-details-marker {
        display: none;
      }
      details[open] summary {
        border-bottom: 1px solid #eee;
        background: #f0f4f2;
      }

      /* ë‚´ë¶€ ê³¼ì œ ì¹´ë“œ */
      .task-list {
        padding: 15px;
      }
      .task-card {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 15px;
        text-decoration: none;
        color: #333;
        border-bottom: 1px solid #f9f9f9;
        transition: 0.2s;
      }
      .task-card:hover {
        background: #f8f9fa;
        transform: translateX(5px);
      }
      .tag {
        font-size: 0.65rem;
        padding: 2px 6px;
        border-radius: 4px;
        font-weight: bold;
        margin-right: 10px;
        background: #eee;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header style="text-align: center; margin-bottom: 40px">
        <h1>ğŸ“‚ WEB ARCHIVE</h1>
        <p>ì£¼ì°¨ë³„ë¡œ ê¹”ë”í•˜ê²Œ ì ‘ì–´ì„œ ê´€ë¦¬í•˜ì„¸ìš”.</p>
      </header>

      <div id="task-container"></div>
    </div>

    <script>
      async function fetchWeekly() {
        const owner = "khy0819";
        const repo = "Goormexp";
        const apiUrl = `https://api.github.com/repos/${owner}/${repo}/git/trees/main?recursive=1`;

        try {
          const res = await fetch(apiUrl);
          const data = await res.json();
          const indexFiles = data.tree.filter(
            (f) =>
              f.path.includes("ê³¼ì œ/") &&
              f.path.endsWith("index.html") &&
              f.path !== "index.html",
          );

          const weeks = {};

          indexFiles.forEach((f) => {
            const pathParts = f.path.split("/");
            const folderName = pathParts[1];
            const dateMatch = folderName.match(/\d+/);

            if (dateMatch) {
              const day = parseInt(dateMatch[0].slice(-2));
              // 1~7ì¼(1ì£¼), 8~14ì¼(2ì£¼), 15~21ì¼(3ì£¼), 22~31ì¼(4ì£¼)ë¡œ ì„ì‹œ ë¶„ë¥˜
              const weekNum = Math.ceil(day / 7);
              const weekKey = `${weekNum}ì£¼ì°¨ (1ì›”)`;

              if (!weeks[weekKey]) weeks[weekKey] = [];
              weeks[weekKey].push({ path: f.path, name: folderName });
            }
          });

          const container = document.getElementById("task-container");
          // ì£¼ì°¨ë³„ë¡œ ì •ë ¬í•´ì„œ ì¶œë ¥
          Object.keys(weeks)
            .sort()
            .forEach((week) => {
              const details = document.createElement("details");
              // ê°€ì¥ ìµœê·¼ ì£¼ì°¨ëŠ” ì—´ì–´ë‘ê¸°
              if (week.includes("4ì£¼ì°¨")) details.open = true;

              let taskHtml = `<summary>${week} <span>â–¾</span></summary><div class="task-list">`;

              weeks[week].forEach((task) => {
                taskHtml += `
                        <a href="${task.path}" class="task-card">
                            <span><span class="tag">DONE</span>${task.name}</span>
                            <span style="color:#ccc">â€º</span>
                        </a>`;
              });

              taskHtml += `</div>`;
              details.innerHTML = taskHtml;
              container.appendChild(details);
            });
        } catch (e) {
          console.error("ë¡œë“œ ì‹¤íŒ¨", e);
        }
      }
      fetchWeekly();
    </script>
  </body>
</html>
