<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Goorm ê³¼ì œ ì €ì¥ì†Œ | íƒ€ì„ë¼ì¸</title>

    <meta
      name="description"
      content="êµ¬ë¦„ KDT ê³¼ì •ì˜ ì—¬ì •ì„ ê¸°ë¡í•˜ëŠ” ì›¹ ì•„ì¹´ì´ë¸Œì…ë‹ˆë‹¤."
    />
    <style>
      /* --- [í°íŠ¸ ë° ë³€ìˆ˜ ì„¤ì •] --- */
      @font-face {
        font-family: "11StreetGothic";
        src: url("https://cdn.jsdelivr.net/gh/projectnoonnu/2601-4@1.1/11StreetGothic-KorLight.woff2") format("woff2");
        font-weight: 300;
        font-display: swap;
      }
      @font-face {
        font-family: "11StreetGothic";
        src: url("https://cdn.jsdelivr.net/gh/projectnoonnu/2601-4@1.1/11StreetGothic-Kor.woff2") format("woff2");
        font-weight: 400;
        font-display: swap;
      }
      @font-face {
        font-family: "11StreetGothic";
        src: url("https://cdn.jsdelivr.net/gh/projectnoonnu/2601-4@1.1/11StreetGothic-KorBold.woff2") format("woff2");
        font-weight: 700;
        font-display: swap;
      }

      :root {
        --primary: #006241;
        --secondary: #e8f5e9;
        --bg: #f8f9fa;
        --accent: #ffeb3b;
        --card-bg: #ffffff;
        --text-main: #333333;
        --text-sub: #888888;
        --border: #eeeeee;
        --cloud-color: #ffffff;
        --arrow-default: #eeeeee;
      }

      [data-theme="dark"] {
        --primary: #4caf50;
        --secondary: #1b2e21;
        --bg: #121212;
        --accent: #ffd600;
        --card-bg: #1e1e1e;
        --text-main: #e0e0e0;
        --text-sub: #aaaaaa;
        --border: #333333;
        --cloud-color: #2c2c2c;
        --arrow-default: #444444;
      }

      body {
        font-family: "11StreetGothic", "Pretendard", sans-serif;
        background: var(--bg);
        margin: 0;
        padding: 40px 20px;
        color: var(--text-main);
        transition: background 0.3s, color 0.3s;
      }
      .container { max-width: 750px; margin: 0 auto; }

      .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        background: var(--card-bg);
        border: 1px solid var(--border);
        padding: 10px;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        font-size: 1.2rem;
      }

      .header-controls {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        margin-top: 15px;
      }

      .calendar-btn {
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 50%;
        width: 45px;
        height: 45px;
        font-size: 1.3rem;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }
      .calendar-btn:hover { transform: scale(1.1); background: var(--secondary); }

      .d-day-badge {
        background: var(--secondary);
        color: var(--primary);
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: 700;
        font-size: 0.85rem;
        border: 1px solid var(--primary);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      }

      header { text-align: center; margin-bottom: 50px; }
      header h1 { color: var(--primary); font-size: 2.8rem; margin-bottom: 8px; font-weight: 700; }
      header p { color: var(--text-sub); font-weight: 300; }

      /* --- [ë¡œë” ë° ì¹´ë“œ ìŠ¤íƒ€ì¼] --- */
      .loader-wrapper { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 120px 0; }
      .cloud {
        width: 120px;
        height: 50px;
        background: var(--cloud-color);
        border-radius: 50px;
        position: relative;
        animation: float 2s ease-in-out infinite;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
      }
      .cloud::after, .cloud::before { content: ""; position: absolute; background: var(--cloud-color); border-radius: 50%; }
      .cloud::after { width: 60px; height: 60px; top: -30px; left: 20px; }
      .cloud::before { width: 50px; height: 50px; top: -25px; right: 20px; }
      .eyes { position: absolute; width: 40px; height: 10px; top: 15px; left: 40px; z-index: 10; display: flex; justify-content: space-between; }
      .eye { width: 6px; height: 6px; background: var(--text-main); border-radius: 50%; animation: blink 3s infinite; }
      @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
      @keyframes blink { 0%, 90%, 100% { transform: scaleY(1); } 95% { transform: scaleY(0.1); } }
      .loading-text { margin-top: 35px; color: var(--primary); font-weight: 700; }

      details { background: var(--card-bg); margin-bottom: 20px; border-radius: 20px; overflow: hidden; box-shadow: 0 8px 20px rgba(0, 0, 0, 0.04); transition: transform 0.3s; }
      details:hover { transform: translateY(-3px); }
      summary { padding: 24px 28px; font-weight: 700; cursor: pointer; list-style: none; display: flex; justify-content: space-between; align-items: center; }
      details[open] summary { background: var(--secondary); color: var(--primary); border-bottom: 1px solid var(--border); }
      .task-list { padding: 5px 15px 20px; }
      .task-card {
        display: flex;
        align-items: center;
        padding: 18px 20px;
        text-decoration: none;
        color: var(--text-main);
        margin-bottom: 8px;
        border-radius: 15px;
        transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      .task-card:hover { background: var(--bg); color: var(--primary); transform: scale(1.02); box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); }
      .tag { width: 60px; text-align: center; font-size: 0.7rem; padding: 4px 0; border-radius: 8px; font-weight: 800; margin-right: 20px; flex-shrink: 0; }
      .tag.quiz { background: var(--accent); color: #856404; }
      .tag.task { background: var(--border); color: var(--text-sub); }
      .task-date { color: var(--text-sub); font-weight: 600; margin-right: 15px; width: 75px; flex-shrink: 0; }
      .task-title { font-weight: 700; flex-grow: 1; font-size: 1.05rem; }
      .arrow { color: var(--arrow-default); font-size: 1.2rem; transition: all 0.3s ease; }
      .task-card:hover .arrow { color: var(--primary); transform: translateX(5px); }
    </style>
  </head>
  <body>
    <button class="theme-toggle" id="theme-btn" title="í…Œë§ˆ ë³€ê²½">ğŸŒ“</button>

    <div class="container">
      <header>
        <h1>WEB ARCHIVE</h1>
        <p id="today-schedule">ì˜¤ëŠ˜ë„ ì½”ë”© ì¤‘!</p>
        <div class="header-controls">
          <button onclick="location.href = 'curriculum.html'" class="calendar-btn" title="ì „ì²´ ì¼ì • ë³´ê¸°">ğŸ“…</button>
          <div id="d-day-badge" class="d-day-badge">D-Day ê³„ì‚° ì¤‘...</div>
        </div>
      </header>

      <div id="loader" class="loader-wrapper">
        <div class="cloud"><div class="eyes"><div class="eye"></div><div class="eye"></div></div></div>
        <div class="loading-text">íŒŒì¼ì„ ì°¾ìœ¼ëŸ¬ í•˜ëŠ˜ì„ ë‚ ê³  ìˆì–´ìš”</div>
      </div>

      <div id="task-container" style="display: none"></div>
    </div>

    <script>
      // 1. í…Œë§ˆ ë° D-Day ì„¤ì •
      const themeBtn = document.getElementById("theme-btn");
      const savedTheme = localStorage.getItem("theme") || "light";
      document.documentElement.setAttribute("data-theme", savedTheme);

      themeBtn.addEventListener("click", () => {
        let theme = document.documentElement.getAttribute("data-theme");
        let targetTheme = theme === "dark" ? "light" : "dark";
        document.documentElement.setAttribute("data-theme", targetTheme);
        localStorage.setItem("theme", targetTheme);
      });

      function updateDDay() {
        const targetDate = new Date("2026-07-17T00:00:00");
        const now = new Date();
        const diff = targetDate - now;
        const daysLeft = Math.ceil(diff / (1000 * 60 * 60 * 24));
        const badge = document.getElementById("d-day-badge");
        if (daysLeft > 0) badge.innerHTML = `ğŸ“ ìˆ˜ë£Œê¹Œì§€ <strong>D-${daysLeft}</strong>`;
        else if (daysLeft === 0) badge.innerHTML = `ğŸ‰ <strong>Today is the Day!</strong>`;
        else badge.innerHTML = `âœ¨ <strong>ìˆ˜ë£Œ ì™„ë£Œ!</strong>`;
      }

      function updateTodaySchedule() {
        const scheduleData = {
          "2026-02-02": "ë¦¬ì•¡íŠ¸ ì…ë¬¸",
          "2026-02-03": "Vite & ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©",
        };
        const now = new Date();
        const todayStr = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, "0")}-${String(now.getDate()).padStart(2, "0")}`;
        const scheduleText = document.getElementById("today-schedule");
        if (scheduleData[todayStr]) scheduleText.innerHTML = `ì˜¤ëŠ˜ì˜ ì¼ì •: <strong>${scheduleData[todayStr]}</strong>`;
      }

      updateDDay();
      updateTodaySchedule();

      // 2. GitHub API í˜ì¹­ - ì¤‘ë³µ ì œê±° ë° ì •í™•í•œ ë‚ ì§œ ë§¤í•‘ ë¡œì§
      async function fetchWeeklyData() {
        const owner = "khy0819";
        const repo = "Goormexp";
        const apiUrl = `https://api.github.com/repos/${owner}/${repo}/git/trees/main?recursive=1`;

        try {
          const res = await fetch(apiUrl);
          const data = await res.json();

          const allIndexFiles = data.tree.filter(
            (f) => f.path.includes("ê³¼ì œ/") && f.path.endsWith("index.html") && f.path !== "index.html"
          );

          // í´ë”ë³„ ìµœì ì˜ index.html ì„ ì • (dist ìš°ì„ )
          const pathMap = new Map();
          allIndexFiles.forEach(f => {
            const pathParts = f.path.split("/");
            const isDist = pathParts.includes("dist");
            // ì‹¤ì œ ê³¼ì œ í´ë”ëª… ì¶”ì¶œ (distë©´ í•œ ë‹¨ê³„ ìœ„)
            const taskFolderName = isDist 
              ? pathParts[pathParts.indexOf("dist") - 1] 
              : pathParts[pathParts.length - 2];
            
            if (isDist) {
              pathMap.set(taskFolderName, f.path);
            } else if (!pathMap.has(taskFolderName)) {
              pathMap.set(taskFolderName, f.path);
            }
          });

          const weeks = {};
          pathMap.forEach((finalPath, taskFolderName) => {
            // ì£¼ì°¨ ì •ë³´ ì°¾ê¸° (ê²½ë¡œì—ì„œ ê²€ìƒ‰)
            const pathParts = finalPath.split("/");
            const weekFolder = pathParts.find((p) => p.toLowerCase().includes("week"));
            let weekLabel = weekFolder ? weekFolder.toUpperCase().replace(/_/g, " ") : "ê¸°íƒ€ ë¶„ë¥˜";

            if (!weeks[weekLabel]) weeks[weekLabel] = [];
            weeks[weekLabel].push({ path: finalPath, name: taskFolderName });
          });

          const container = document.getElementById("task-container");
          document.getElementById("loader").style.display = "none";
          container.style.display = "block";

          const sortedWeeks = Object.keys(weeks).sort((a, b) =>
            a.localeCompare(b, undefined, { numeric: true })
          );

          sortedWeeks.forEach((week) => {
            const details = document.createElement("details");
            if (week === sortedWeeks[sortedWeeks.length - 1]) details.open = true;

            let html = `<summary><span>ğŸ“‚ ${week}</span> <span style="font-size:0.8rem; opacity:0.4;">${weeks[week].length} Tasks</span></summary><div class="task-list">`;

            weeks[week]
              .sort((a, b) => a.name.localeCompare(b.name))
              .forEach((task) => {
                const parts = task.name.split("-");
                const datePart = parts[0] || "ë‚ ì§œë¯¸ìƒ";
                let isQuiz = task.name.toUpperCase().includes("QUIZ");
                let titlePart = parts.slice(1).join("-") || "ê³¼ì œë¬¼";
                titlePart = titlePart.replace(/^(QUIZ|TASK)[-_]?/i, "").trim();

                html += `
                <a href="${encodeURI(task.path)}" class="task-card">
                  <span class="tag ${isQuiz ? 'quiz' : 'task'}">${isQuiz ? 'QUIZ' : 'TASK'}</span>
                  <span class="task-date">${datePart}</span>
                  <span class="task-title">${titlePart}</span>
                  <span class="arrow">â†’</span>
                </a>`;
              });
            html += `</div>`;
            details.innerHTML = html;
            container.appendChild(details);
          });
        } catch (e) {
          document.getElementById("loader").innerHTML = "â˜ï¸ ë°ì´í„° ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";
        }
      }
      fetchWeeklyData();
    </script>
  </body>
</html>