<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>Goorm ê³¼ì œ ì €ì¥ì†Œ (ì£¼ì°¨ë³„ ì •ë¦¬)</title>
    <style>
      :root {
        --primary: #006241;
        --bg: #f8f9fa;
      }
      body {
        font-family: "Pretendard", sans-serif;
        background: var(--bg);
        margin: 0;
        padding: 40px 20px;
        color: #333;
      }
      .container {
        max-width: 750px;
        margin: 0 auto;
      }
      header {
        text-align: center;
        margin-bottom: 50px;
      }
      header h1 {
        color: var(--primary);
        font-size: 2rem;
        margin-bottom: 10px;
      }

      /* ì£¼ì°¨ë³„ ê·¸ë£¹ (ì•„ì½”ë””ì–¸) */
      details {
        background: white;
        margin-bottom: 15px;
        border-radius: 15px;
        border: 1px solid #eee;
        overflow: hidden;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.03);
      }
      summary {
        padding: 22px;
        font-weight: 800;
        cursor: pointer;
        list-style: none;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #fff;
        color: #444;
        font-size: 1.1rem;
      }
      details[open] summary {
        border-bottom: 1px solid #eee;
        background: #f9fdfb;
        color: var(--primary);
      }
      summary::after {
        content: "ï¼‹";
        font-size: 1.2rem;
        color: #ccc;
        transition: 0.3s;
      }
      details[open] summary::after {
        content: "ï¼";
        transform: rotate(180deg);
        color: var(--primary);
      }

      /* ë‚´ë¶€ ê³¼ì œ ë¦¬ìŠ¤íŠ¸ */
      .task-list {
        padding: 10px 20px 20px;
      }
      .task-card {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        text-decoration: none;
        color: inherit;
        border-bottom: 1px solid #f1f1f1;
        transition: 0.2s;
      }
      .task-card:last-child {
        border-bottom: none;
      }
      .task-card:hover {
        transform: translateX(10px);
        color: var(--primary);
      }

      .tag {
        font-size: 0.7rem;
        padding: 3px 8px;
        border-radius: 4px;
        font-weight: 800;
        margin-right: 12px;
        background: #eee;
      }
      .tag.quiz {
        background: #fff5b1;
        color: #856404;
      }
      .tag.project {
        background: #d4edda;
        color: #155724;
      }

      .loader {
        text-align: center;
        padding: 50px;
        color: #aaa;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>ğŸ“‚ WEB ARCHIVE</h1>
        <p>ì£¼ì°¨ë³„ë¡œ í´ë”ë¥¼ ê´€ë¦¬í•˜ë©´ ìë™ìœ¼ë¡œ ì •ë¦¬ë©ë‹ˆë‹¤.</p>
      </header>

      <div id="loader" class="loader">ê³¼ì œ ë°ì´í„°ë¥¼ ë¶„ì„ ì¤‘...</div>
      <div id="task-container"></div>
    </div>

    <script>
      async function fetchWeeklyData() {
        const owner = "khy0819";
        const repo = "Goormexp";
        const apiUrl = `https://api.github.com/repos/${owner}/${repo}/git/trees/main?recursive=1`;

        try {
          const res = await fetch(apiUrl);
          const data = await res.json();

          // 'ê³¼ì œ/' í´ë” ì•ˆì˜ index.htmlë“¤ë§Œ í•„í„°ë§
          const indexFiles = data.tree.filter(
            (f) =>
              f.path.includes("ê³¼ì œ/") &&
              f.path.endsWith("index.html") &&
              f.path !== "index.html",
          );

          const weeks = {};

          indexFiles.forEach((f) => {
            const pathParts = f.path.split("/");
            // pathParts ì˜ˆ: ["ê³¼ì œ", "Week3", "0126_quiz", "index.html"]
            let weekLabel = "ê¸°íƒ€ ë¶„ë¥˜";
            let folderName = pathParts[pathParts.length - 2];

            // ê²½ë¡œ ì¤‘ì— 'Week'ê°€ í¬í•¨ëœ í´ë”ëª…ì„ ì£¼ì°¨ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©
            const weekFolder = pathParts.find((p) =>
              p.toLowerCase().includes("week"),
            );
            if (weekFolder) weekLabel = weekFolder.toUpperCase();

            if (!weeks[weekLabel]) weeks[weekLabel] = [];
            weeks[weekLabel].push({ path: f.path, name: folderName });
          });

          const container = document.getElementById("task-container");
          document.getElementById("loader").style.display = "none";

          // ì£¼ì°¨ë³„ ì •ë ¬ (Week1, Week2... ìˆœì„œ)
          const sortedWeeks = Object.keys(weeks).sort((a, b) => {
            return a.localeCompare(b, undefined, {
              numeric: true,
              sensitivity: "base",
            });
          });

          sortedWeeks.forEach((week) => {
            const details = document.createElement("details");
            // ê°€ì¥ ë§ˆì§€ë§‰ ì£¼ì°¨(ìµœì‹ )ëŠ” ê¸°ë³¸ìœ¼ë¡œ ì—´ì–´ë‘ê¸°
            if (week === sortedWeeks[sortedWeeks.length - 1])
              details.open = true;

            let html = `<summary>${week} (${weeks[week].length}ê°œ ê³¼ì œ)</summary><div class="task-list">`;

            weeks[week].forEach((task) => {
              let tagText = "TASK",
                tagClass = "";
              const lowerName = task.name.toLowerCase();
              if (lowerName.includes("quiz")) {
                tagText = "QUIZ";
                tagClass = "quiz";
              }
              if (
                lowerName.includes("starbucks") ||
                lowerName.includes("clone")
              ) {
                tagText = "PROJ";
                tagClass = "project";
              }

              html += `
                        <a href="${task.path}" class="task-card">
                            <span><span class="tag ${tagClass}">${tagText}</span><strong>${task.name}</strong></span>
                            <span style="color:#eee">â€º</span>
                        </a>`;
            });

            html += `</div>`;
            details.innerHTML = html;
            container.appendChild(details);
          });
        } catch (e) {
          document.getElementById("loader").innerText =
            "ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
        }
      }
      fetchWeeklyData();
    </script>
  </body>
</html>
